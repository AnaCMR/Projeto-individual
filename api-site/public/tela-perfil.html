<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ana's Garden - Perfil</title>
  <link rel="stylesheet" href="css/tela-perfil.css" />
  <link rel="icon" href="icons/plant.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Cinzel&family=Courgette&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="js/funcoes.js"></script>
</head>

<body onload="validarSessao()" >
  <menu class="menu">
    <nav class="container">
      <a href="index.html">
        <img class="logo" src="icons/logo.png" alt="logo" />
      </a>
      <ul>
        <li class="tooltip">
          <span class="tooltiptext">Perfil </span>
          <img class="icons-menu" src="icons/user.png" alt="Perfil"></a>
        </li><br>
        <li class="tooltip"><a href="tela-videos.html"><img class="icons-menu" src="icons/midia.png"
              alt="Vídeos"></a>
          <span class="tooltiptext">Vídeos </span>
        </li>
        <li class="tooltip"><a href="tela-conhecimento.html"><img class="icons-menu" src="icons/monitor.png"
              alt="aprendizado"></a>
          <span class="tooltiptext"> Aprendizado diário </span>
        </li>
      </ul>
    </nav>
  </menu>

  <section class="profile">
    <div class="container-profile">
      <div class="user-profile">
        <div class="photo-profile-div">
          <img class="photo-profile" id="profile_1" width="100%"
            src="imgs/profile-1.gif" alt="foto de perfil">
            <img class="photo-profile" id="profile_2" width="100%"
            src="imgs/profile-2.gif" alt="foto de perfil">
            <img class="photo-profile" id="profile_3" width="100%"
            src="imgs/profile-3.gif" alt="foto de perfil">
            <img class="photo-profile" id="profile_4" width="100%"
            src="imgs/profile-4.gif" alt="foto de perfil">
        </div>
        <div class="profile-content">
          <h2 id="b_usuario"></h2>
          <h4 id="h1_login_usuario" ></h4>
        </div>
        <div class="buttons">
          <button onclick="change_email()">Mudar email</button>
          <button onclick="change_password()">Mudar senha</button>
        </div>
        <br>
        <div id="show_email">
          <label>Insira seu novo email:</label> <br>
          <input id="email_input" > <br>
          <label>Insira sua senha:</label> <br>
          <input id="password_input" type="password" >
          <img
          id="olho_aberto_email"
          title="ocultar senha"
          class="olho_aberto"
          src="icons/see.png"
          onclick="changeImage()"
          alt="mudar para senha visivel"
        />
        <img
          id="olho_fechado_email"
          class="olho_fechado"
          onclick="ver()"
          src="icons/cloudy.png"
          alt="mudar para senha não visivel"
        />
          <button onclick="confirm_email()">Confirmar</button>
        </div>
        <div id="show_password">
          <label>Insira sua senha antiga:</label><br>
          <input id="senhaAntiga_input" type="password">
          <img
          id="olho_aberto_antiga"
          title="ocultar senha"
          class="olho_aberto"
          src="icons/see.png"
          onclick="changeImage()"
          alt="mudar para senha visivel"
        />
        <img
          id="olho_fechado_antiga"
          class="olho_fechado"
          onclick="ver()"
          src="icons/cloudy.png"
          alt="mudar para senha não visivel"
        /><br>
          <label>Insira nova senha:</label>
          <br>
          <input id="novaSenha_input" type="password">
          <img
          id="olho_aberto_nova"
          title="ocultar senha"
          class="olho_aberto"
          src="icons/see.png"
          onclick="changeImage()"
          alt="mudar para senha visivel"
        />
        <img
          id="olho_fechado_nova"
          class="olho_fechado"
          onclick="ver()"
          src="icons/cloudy.png"
          alt="mudar para senha não visivel"
        /><br>
          <label>Confirme a nova senha:</label><br>
          <input id="confirmPassword" type="password">
          <img
          id="olho_aberto_confirmar"
          title="ocultar senha"
          class="olho_aberto"
          src="icons/see.png"
          onclick="changeImage()"
          alt="mudar para senha visivel"
        />
        <img
          id="olho_fechado_confirmar"
          class="olho_fechado"
          onclick="ver()"
          src="icons/cloudy.png"
          alt="mudar para senha não visivel"
        />
          <button onclick="confirm_password()">Confirmar</button>

        </div>
      </div>
      <div class="preferences">

        <div class="plant">
          <h3>Minhas plantas preferidas:</h3>
          <div class="boxes">
            <div class="photo-1">
              <div class="photo" id="photo_1">
                <img src="icons/hanging.png" alt="">
              </div>

              <select id="favorite_plant_1" onchange="change_photo_1()">
                <option value="icons/hanging.png">Selecione...</option>
                <option
                  value="https://static3.tcdn.com.br/img/img_prod/350075/samambaia_americana_8677_1_20190521161357.jpg">
                  Samambaia</option>
                <option value="https://cdn.awsli.com.br/1000x1000/1112/1112786/produto/53378674/3b9dc65dc5.jpg">Jibóia
                </option>
                <option
                  value="https://imagens-revista.vivadecora.com.br/uploads/2020/09/croton-petra-planta-em-casa-pinterest.jpg">
                  Cróton</option>
                <option
                  value="https://www.sitiodamata.com.br/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/b/e/begonia_maculata_begonia_maculata_4.jpg">
                  Begonia</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/1d40478c-3858-4864-824b-82636a6577c5.jpeg">
                  Columeia</option>
                <option
                  value="https://www.paulistaflores.com.br/image/cache/data/produtos/plantadas/fily01---ficus-lyrata/ficus-lyata-1-926x926.jpg">
                  Ficus Lyrata</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/17d3fa6e-9b24-4931-84c5-4899c930c7f2.png">
                  Sigonio</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/76b1f24d-c390-41e5-9d77-32d65e77b7b0.jpg">
                  Avenca</option>
                <option value="https://www.flaviarocco.com.br/media/wysiwyg/categorias/Girassol1.jpg">Girassol</option>
                <option
                  value="https://images.tcdn.com.br/img/img_prod/798302/lirio_da_paz_185_3_591ef64368ccd4f2ea6ef9be695a80d0.jpg">
                  Lirio da paz</option>
                <option value="https://brasilnativas.com.br/wp-content/uploads/2021/02/azaleia-600x600-1-600x600.jpg">
                  Azaleia</option>
                <option
                  value="https://lh3.googleusercontent.com/proxy/BnVVfu9rnoAkOSTPNer4iG8BdpAk_Lx2JGcBXguyalwnbF8__tsmoX6IvI7Cov6DuEA_JiL_gVLnNPnkU7FcDYQaz9-hMnWOYLlF1DdeQs4Mjt8">
                  Violeta</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/cbdb521e-12af-40a6-8035-9552390882b3.png">
                  Lambari-Roxo</option>
                <option
                  value="https://static.wixstatic.com/media/de9724_37af698808e34ae8a5de582d607eab0b~mv2.jpg/v1/fill/w_1125,h_1500,al_c,q_85/de9724_37af698808e34ae8a5de582d607eab0b~mv2.jpg">
                  Pacová</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/5f9f913e-5434-4862-9ce2-d5c7db663c69.png">
                  Hera</option>
              </select>
            </div>
            <div class="photo-2">
              <div class="photo" id="photo_2"><img src="icons/plants.png" alt=""></div>
              <select id="favorite_plant_2" onchange="change_photo_2()">
                <option value="icons/plants.png">Selecione...</option>
                <option
                  value="https://static3.tcdn.com.br/img/img_prod/350075/samambaia_americana_8677_1_20190521161357.jpg">
                  Samambaia</option>
                <option value="https://cdn.awsli.com.br/1000x1000/1112/1112786/produto/53378674/3b9dc65dc5.jpg">Jibóia
                </option>
                <option
                  value="https://imagens-revista.vivadecora.com.br/uploads/2020/09/croton-petra-planta-em-casa-pinterest.jpg">
                  Cróton</option>
                <option
                  value="https://www.sitiodamata.com.br/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/b/e/begonia_maculata_begonia_maculata_4.jpg">
                  Begonia</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/1d40478c-3858-4864-824b-82636a6577c5.jpeg">
                  Columeia</option>
                <option
                  value="https://www.paulistaflores.com.br/image/cache/data/produtos/plantadas/fily01---ficus-lyrata/ficus-lyata-1-926x926.jpg">
                  Ficus Lyrata</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/17d3fa6e-9b24-4931-84c5-4899c930c7f2.png">
                  Sigonio</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/76b1f24d-c390-41e5-9d77-32d65e77b7b0.jpg">
                  Avenca</option>
                <option value="https://www.flaviarocco.com.br/media/wysiwyg/categorias/Girassol1.jpg">Girassol</option>
                <option
                  value="https://images.tcdn.com.br/img/img_prod/798302/lirio_da_paz_185_3_591ef64368ccd4f2ea6ef9be695a80d0.jpg">
                  Lirio da paz</option>
                <option value="https://brasilnativas.com.br/wp-content/uploads/2021/02/azaleia-600x600-1-600x600.jpg">
                  Azaleia</option>
                <option
                  value="https://lh3.googleusercontent.com/proxy/BnVVfu9rnoAkOSTPNer4iG8BdpAk_Lx2JGcBXguyalwnbF8__tsmoX6IvI7Cov6DuEA_JiL_gVLnNPnkU7FcDYQaz9-hMnWOYLlF1DdeQs4Mjt8">
                  Violeta</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/cbdb521e-12af-40a6-8035-9552390882b3.png">
                  Lambari-Roxo</option>
                <option
                  value="https://static.wixstatic.com/media/de9724_37af698808e34ae8a5de582d607eab0b~mv2.jpg/v1/fill/w_1125,h_1500,al_c,q_85/de9724_37af698808e34ae8a5de582d607eab0b~mv2.jpg">
                  Pacová</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/5f9f913e-5434-4862-9ce2-d5c7db663c69.png">
                  Hera</option>
              </select>
            </div>
            <div class="photo-3">
              <div class="photo" id="photo_3"><img src="icons/seed.png" alt=""></div>
              <select id="favorite_plant_3" onchange="change_photo_3()">
                <option value="icons/seed.png">Selecione...</option>
                <option
                  value="https://static3.tcdn.com.br/img/img_prod/350075/samambaia_americana_8677_1_20190521161357.jpg">
                  Samambaia</option>
                <option value="https://cdn.awsli.com.br/1000x1000/1112/1112786/produto/53378674/3b9dc65dc5.jpg">Jibóia
                </option>
                <option
                  value="https://imagens-revista.vivadecora.com.br/uploads/2020/09/croton-petra-planta-em-casa-pinterest.jpg">
                  Cróton</option>
                <option
                  value="https://www.sitiodamata.com.br/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/b/e/begonia_maculata_begonia_maculata_4.jpg">
                  Begonia</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/1d40478c-3858-4864-824b-82636a6577c5.jpeg">
                  Columeia</option>
                <option
                  value="https://www.paulistaflores.com.br/image/cache/data/produtos/plantadas/fily01---ficus-lyrata/ficus-lyata-1-926x926.jpg">
                  Ficus Lyrata</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/17d3fa6e-9b24-4931-84c5-4899c930c7f2.png">
                  Sigonio</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/76b1f24d-c390-41e5-9d77-32d65e77b7b0.jpg">
                  Avenca</option>
                <option value="https://www.flaviarocco.com.br/media/wysiwyg/categorias/Girassol1.jpg">Girassol</option>
                <option
                  value="https://images.tcdn.com.br/img/img_prod/798302/lirio_da_paz_185_3_591ef64368ccd4f2ea6ef9be695a80d0.jpg">
                  Lirio da paz</option>
                <option value="https://brasilnativas.com.br/wp-content/uploads/2021/02/azaleia-600x600-1-600x600.jpg">
                  Azaleia</option>
                <option
                  value="https://lh3.googleusercontent.com/proxy/BnVVfu9rnoAkOSTPNer4iG8BdpAk_Lx2JGcBXguyalwnbF8__tsmoX6IvI7Cov6DuEA_JiL_gVLnNPnkU7FcDYQaz9-hMnWOYLlF1DdeQs4Mjt8">
                  Violeta</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/cbdb521e-12af-40a6-8035-9552390882b3.png">
                  Lambari-Roxo</option>
                <option
                  value="https://static.wixstatic.com/media/de9724_37af698808e34ae8a5de582d607eab0b~mv2.jpg/v1/fill/w_1125,h_1500,al_c,q_85/de9724_37af698808e34ae8a5de582d607eab0b~mv2.jpg">
                  Pacová</option>
                <option
                  value="https://static.cloud-boxloja.com/lojas/9s0e9/produtos/5f9f913e-5434-4862-9ce2-d5c7db663c69.png">
                  Hera</option>
              </select>
            </div>
          </div>
        </div>
        <div class="plant">
        
          <label class="motive-title">Quero cancelar meu cadastro</label> <br><br>
          <select id="motive_cancel" onchange="options_cancel()">
            <option value="">Selecione...</option>
            <option value="gosto">O conteúdo não é o que eu esperava</option>
            <option value="foco">Não estou mais focada no assunto</option>
            <option value="outro">Outro...</option>
          </select>
          <div>
            
            <label id="confirm_title">Insira sua senha:</label> <br>
          <input id="confirm_cancel_input" type="password" >
          <img
          id="olho_aberto_cancelar"
          title="ocultar senha"
          class="olho_aberto"
          src="icons/see.png"
          onclick="changeImage()"
          alt="mudar para senha visivel"
        />
        <img
          id="olho_fechado_cancelar"
          class="olho_fechado"
          onclick="ver()"
          src="icons/cloudy.png"
          alt="mudar para senha não visivel"
        />
            <input type="text" id="other" placeholder="Escreva o motivo">
            <button onclick="send_cancel()" id="show_button">Enviar</button>
          </div>
          </div>
        </div>
      </div>
    </div>

    <div id="blur_div_cadastro">.
      <div id="cadastro_div">
        <img
          src="https://4.bp.blogspot.com/-cUfLvOzBmao/XgAEVeLKfTI/AAAAAAAWcrc/7hGym4ePH944P41LKqH4dNYRpqZgXdROACLcBGAsYHQ/s1600/AW4119480_07.gif?time=Sat%20Nov%2006%202021%2021:28:05%20GMT-0300%20(Hor%C3%A1rio%20Padr%C3%A3o%20de%20Bras%C3%ADlia)">
        <h5>Você vai nos deixar? <br> <br> Por favor, envie um email para garden@garden.com. <br><br> Preciso saber o
          que eu fiz de errado</h5>
          <div class="buttons-cancel" >
          <button onclick="back_cadastro()">Mudei de ideia!</button>
          <button onclick="confirm_cancel()">Quero mesmo cancelar</button>
        </div>
      </div>
    </div>
  </section>
</body>

</html>
<script src="js/perfil.js"></script>
<script>
  function confirm_email() {
    var emailVar = email_input.value;
    var passwordVar = password_input.value;

    if (emailVar == "" || passwordVar == "") {

window.alert("Preencha todos os campos para prosseguir!");
if (emailVar == "") {
    console.log('email está em branco')
}
if (passwordVar == "") {
    console.log('text está em branco')
}

return false;
}

fetch("/usuarios/novoemail", {
          method: "POST",
          headers: {
              "Content-Type": "application/json"
          },
          body: JSON.stringify({
              email: emailVar.toLowerCase(),
              senha: passwordVar,
          })
        }).then(function (resposta) {

console.log("resposta: ", resposta);

if (resposta.ok) {
    window.alert("Informação enviada com sucesso!");
    window.location = "./index.html"
    limparFormulario();
   
} else {
    throw ("Houve um erro ao tentar realizar a alteração!");
}
}).catch(function (resposta) {
console.log(`#ERRO: ${resposta}`);
window.alert("Informação enviada com sucesso! Por favor, faça o login novamente");
window.location = "./index.html"

});

return false;
}

function confirm_password() {
    var novasenhaVar = novaSenha_input.value;
    var senhaantigaVar = senhaAntiga_input.value;
    var confirmarSenha = confirmPassword.value;

    if (novasenhaVar == "" || senhaantigaVar == "" || confirmarSenha == "") {

window.alert("Preencha todos os campos para prosseguir!");
if (novasenhaVar == "") {
    console.log('nova senha está em branco')
}
if (senhaantigaVar == "") {
    console.log('senha antiga está em branco')
}
if (confirmarSenha == "") {
  console.log('confirmar senha está em branco')
}

return false;
}

if (novasenhaVar == confirmarSenha){
  
fetch("/usuarios/novasenha", {
          method: "POST",
          headers: {
              "Content-Type": "application/json"
          },
          body: JSON.stringify({
              nova_senha: novasenhaVar,
              senha_antiga: senhaantigaVar,
          })
        }).then(function (resposta) {

console.log("resposta: ", resposta);

if (resposta.ok) {
    window.alert("Informação enviada com sucesso!");
    location.reload();
    limparFormulario();
   
} else {
    throw ("Houve um erro ao tentar realizar a alteração");

}
}).catch(function (resposta) {
console.log(`#ERRO: ${resposta}`);
window.alert("Informação enviada com sucesso!");
    location.reload();
});

} else {
  alert('Senhas não conferem');
}

return false;
}


function confirm_cancel() {
    var senhaCancelamentVar = confirm_cancel_input.value;

    if (senhaCancelamentVar == "") {

window.alert("Preencha todos os campos para prosseguir!");
if (senhaCancelamentVar == "") {
    console.log('nova senha está em branco')
}

return false;
}
  
fetch("/usuarios/cancelarusuario", {
          method: "POST",
          headers: {
              "Content-Type": "application/json"
          },
          body: JSON.stringify({
            cancelar: senhaCancelamentVar,
          })
        }).then(function (resposta) {

console.log("resposta: ", resposta);

if (resposta.ok) {
    window.alert("Espero que não seja um adeus! Caso mude de ideia, é só se cadastrar novamente");
    window.location = "./index.html";
    limparFormulario();
   
} else {
    throw ("Houve um erro ao tentar deletar o cadastro");

}
}).catch(function (resposta) {
console.log(`#ERRO: ${resposta}`);
window.alert("Espero que não seja um adeus! Caso mude de ideia, é só se cadastrar novamente");
window.location = "./index.html";

});
return false;
} 

var photo_profile = [profile_1, profile_2, profile_3, profile_4];

function profileRandom(photoArr) {
  var content_photo = photoArr[Math.floor(Math.random() * photoArr.length)];
  return (content_photo.style.display = "block");
  }


console.log(profileRandom(photo_profile));
    
</script>