<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ana's Garden - E se seu parceiro ama plantas?</title>
    <link rel="stylesheet" href="css/love.css" />
    <link rel="icon" href="icons/plant.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Cinzel&family=Courgette&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

    <script src="./js/funcoes.js"></script>


  </head>

<body>
    <div class="container">
        <header class="header">
            <div class="logo-div">
                <a href="index.html">
                    <img class="logo" src="icons/logo.png" alt="logo" />
                </a>
            </div>
            <nav class="container">
                <ul class="navbar">
                    <li><a href="index.html"> Home</a></li>
                    <li><a href="contato.html">Fale conosco </a></li>
                </ul>
                <button class="login" onclick="login()">Login</button>
                <button onclick="cadastro()">Cadastre-se</button>
            </nav>
        </header>
    </div>
    <div class="space">.</div>
    <div id="blur_div_cadastro">
      .
      <div id="cadastro_div">
        <p class="close" onclick="back_cadastro()">X</p>
        <!-- <form id="form_cadastro" method="post"  onsubmit="return cadastrar()"> -->
          <label class="login_label">Nome:</label><br />
          <input name="nome" class="login_input" id="name_user" /><br />
          <label class="login_label">E-mail:</label><br />
          <input name="email" class="login_input" id="user_email" /><br />
          <div class="div_perfil">
            <div class="age_data">
              <label class="login_label">Data Nascimento:</label><br />
              <input
                name="idade"
                type="date"
                class="login_input age"
                id="age_input"
              /><br />
            </div>
            <div class="gender_data">
              <label class="genero">Gênero</label><br />
              <select class="login_select_gender" id="gender_select">
                <option value="">Selecione...</option>
                <option value="f">F</option>
                <option value="m">M</option>
                <option value="nao informado">Prefiro não informar</option>
              </select> 
            </div>
          </div>
          <label class="login_label">Senha:</label><br />
          <input
          title="mostrar senha"
            name="senha"
            class="login_input"
            type="password"
            id="password_user"
          />
          <img
          id="olho_aberto_cadastro1"
          title="ocultar senha"
          class="olho_aberto"
          src="icons/see.png"
          onclick="changeImage()"
          alt="mudar para senha visivel"
        />
        <img
          id="olho_fechado_cadastro1"
          class="olho_fechado"
          onclick="ver()"
          src="icons/cloudy.png"
          alt="mudar para senha não visivel"
        />
<br />

          <label class="login_label">Confirmar senha:</label><br />
          <input
            class="login_input"
            name="confirmacao-senha"
            type="password"
            id="confirm_password"
            title="mostrar senha"
          /><img
          id="olho_aberto_cadastro2"
          class="olho_aberto"
          src="icons/see.png"
          onclick="changeImage()"
          alt="mudar para senha visivel"
        />
        <img
          id="olho_fechado_cadastro2"
          class="olho_fechado"
          title="ocultar senha"
          onclick="ver()"
          src="icons/cloudy.png"
          alt="mudar para senha não visivel"
        /><br />

          <br />

          <button class="welcome" onclick="cadastrar()">Cadastrar-se</button>
        <!-- </form> -->
      </div>
      <div id="div_aguardar" class="loading-div">
        
    </div>

    <div id="div_erros_login"></div>

    </div>
  
      <div id="blur_div">
        .
        <div id="login_div">
          <p class="close" onclick="back_login()">X</p>
          <form id="form_login" method="post" onsubmit="return entrar()">
            <label class="login_label">E-mail:</label><br />
            <input name="email_login" class="login_input" id="user_email_login" /><br />
            <label class="login_label">Senha:</label><br />
            <input
              name="senha_login"
              class="login_input"
              type="password"
              id="password_user_login"
            /><img
            id="olho_aberto_login"
            title="mostrar senha"
            class="olho_aberto"
            src="icons/see.png"
            onclick="changeImage()"
            alt="mudar para senha visivel"
          />
          <img
            id="olho_fechado_login"
            class="olho_fechado"
            title="ocultar senha"
            onclick="ver()"
            src="icons/cloudy.png"
            alt="mudar para senha não visível"
          /><br />
            <br />
            <button class="welcome" type="submit">
              Entrar
            </button>
          </form>
        </div>
        <div id="div_aguardar" class="loading-div">
      </div>
  
      <div id="div_erros_login"></div>
      </div>

      <section class="daily-article">
        <h3 class="title-article">O que dar de presente para um louco das plantas?</h3>
        <div class="container-article">
            
            
            <div class="content-article">
                
                <p><span class="upper"> A</span>mantes de plantas e flores adoram estar perto da natureza!

                    <p>Ainda que presentear um amigo, parente ou conhecido pareça uma tarefa difícil, conhecer suas características e gostos é a melhor forma de encontrar o presente perfeito. </p>
                    
                    <p>  Além das mudas, presente certeiro para os apreciadores de plantas, há diversos itens que remetem ao universo verde que podem encantar os apaixonados por jardinagem.</p>
                <p>
                  <span class="number">1.</span> <h4 class="gift"> Bulbos de flores</h4>
                  Presentear amantes de plantas com bulbos de flores é sempre uma boa opção.</p>
                  <p>
                  Por investirem tempo e energia nos cuidados com o jardim e acompanharem o desenvolvimento de todas as espécies que cultivam, podem amar receber novas mudas e bulbos para plantar.
                </p>
                <p>
                  <span class="number">2.</span> <h4 class="gift">Vasos autoirrigáveis</h4>
                  Outro ótimo presente para quem gosta de plantas são os vasos ou jardineiras autoirrigáveis, que adicionam praticidade ao dia a dia.
                </p>
                <p>Por possuírem um reservatório de água e cordões que funcionam como uma raiz artificial, garantindo a umidade da planta, dispensam a rega diária que diversas plantas exigem.</p>
                <p>Além de adicionarem muita personalidade à decoração da casa, esse tipo de vaso é ideal para pessoas que querem otimizar o tempo de cuidado com as plantas ou que viajam muito, o que pode acarretar na perda dos cultivos por falta de rega.</p>
                <span class="number">3.</span> <h4 class="gift">Cosméticos naturais</h4>
<p>A tendência dos cosméticos naturais também pode ser aproveitada na hora de escolher presentes para amantes da natureza.</p> 

<p>Os produtos naturais, que não contém aditivos químicos em sua composição, como cremes e óleos, são ótimas opções!</p>

<span class="number">4.</span>  <h4 class="gift">Itens de decoração</h4> <p>
Artigos que remetem à natureza também são presentes para quem gosta de plantas!</p>

<p>
 Almofadas, quadros, xícaras, cadernos, caixas, bandejas são algumas das infinitas opções criativas de presentes para decorar diferentes ambientes.

<p> Aparadores e tripés para vasos também são ótimas opções para quem gosta de integrar plantas aos ambientes internos. </p>
          
            </div>
            <div>
              <div class="detail-article-2">"Percebi o quanto as plantas são importantes para a vida na casa. Aumenta a paz e a sensação de conforto na casa"</div>
              
              <img src="imgs/foto Gui resumo.jpg" alt="" class="image-plant">
                <img class="image-plant" src="imgs/love.jpg" alt="foto de cachorro coberto com folhagem" />
                <div class="detail-article">.</div>
                <img class="image-plant" src="imgs/love-2.jpg" alt="foto de cachorro coberto com folhagem" />
                <div class="detail-article">.</div>
            </div>

            </div>
            <section class="rate">
                <p>Gostou da matéria? Se gostou deixe seu like <img onclick="like()" class="icon-like" id="like_heart"
                        src="icons/like.png" alt="coração de curtida"> <span id="change_like" class="small">
                        <img onclick="deslike()" class="icon-like" src="icons/heart.png" alt="coração de curtida"> você e
                        outras <span id="numbers_like">30</span> pessoas
                        gostaram. </span> </p>
            </section>
      <section class="old-articles">
        <p>Veja algumas matérias que você pode se interessar</p>
        <div class="articles">
            <div class="box-article"><a href="urban-jungle.html">
                    <img src="imgs/urban-jungle1.png" alt="Foto de urban jungle">
                    <h4>Você sabe o que é Urban Jungle?</h4>
                </a>
            </div>
            <div class="box-article"><a href="bedroom.html">
                <img src="imgs/bedroom-1.png" alt="Foto de quarto com plantas">
                <h4>Posso ter plantas no quarto?</h4>
                </a>
            </div>
            <div class="box-article"><a href="pet.html">
                    <img src="imgs/pet-1.png" alt="Cachorro coberto por folhagem de jibóia">
                    <h4>Animais e plantas?</h4>
                </a>
            </div>
            <div class="box-article"> <a href="hortoterapia.html">
                    <img src="imgs/plantas-artigo-1.png" alt="Foto de plantas">
                    <h4>Por que fazer hortoterapia?</h4>
                </a>
            </div>
        </div>
    </section>


    <footer id="footer">
        <p>Ana Marques &copy; 2021</p>
        <p>Todos os direitos reservados</p>
    </footer>

</body>

</html>
<script src="js/functions.js"></script>
<script>
  function limparFormulario() {
document.getElementById("form_cadastro").reset();
}


function cadastrar() {
aguardar();

// var formulario = new FormData(document.getElementById("form_cadastro"));

var nomeVar = name_user.value;
var emailVar = user_email.value;
var senhaVar = password_user.value;
var confirmacaoSenha = confirm_password.value;
var idadeVar = age_input.value
var generoVar = gender_select.value

if (nomeVar == "" || emailVar == "" || senhaVar == "" || confirmacaoSenha == "") {

  window.alert("Preencha todos os campos para prosseguir!");
  if (nomeVar == "") {
      console.log('nome está em branco')
  }
  if (emailVar == "") {
      console.log('email está em branco')
  }
  if (senhaVar == "") {
      console.log('senha está em branco')
  }
  if (confirmacaoSenha == "") {
      console.log('confirmacaoSenha está em branco')
  }
  if (idadeVar == "") {
      console.log('idade está em branco')
  }
  if (generoVar == "") {
      console.log('genero está em branco')
  }
  finalizarAguardar();
  return false;
}

 if (emailVar.indexOf("@") == -1 || emailVar.toLowerCase().indexOf(".com") == -1) {
   window.alert("Ops, e-mail inválido! Verifique e tente novamente.");
   finalizarAguardar();
   return false;
 }

if (senhaVar != confirmacaoSenha) {
  window.alert("As senhas inseridas devem ser iguais para prosseguir!");
  finalizarAguardar();
  return false;
}

fetch("/usuarios/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                nome: nomeVar.toLowerCase(),
                email: emailVar.toLowerCase(),
                senha: senhaVar,
                idade: idadeVar,
                genero: generoVar,
            })
          }).then(function (resposta) {

  console.log("resposta: ", resposta);

  if (resposta.ok) {
      window.alert("Cadastro realizado com sucesso!");
      location.reload();;
      limparFormulario();
      finalizarAguardar();
  } else {
      throw ("Houve um erro ao tentar realizar o cadastro!");
  }
}).catch(function (resposta) {
  console.log(`#ERRO: ${resposta}`);
  finalizarAguardar();
});

return false;
}
function limparFormulario() {
        document.getElementById("form_login").reset();
    }

    function entrar() {
        aguardar();

        var formulario = new URLSearchParams(new FormData(document.getElementById("form_login")));

        var email = formulario.get("email_login");
        var senha = formulario.get("senha_login");

        console.log("FORM LOGIN: ", email);
        console.log("FORM SENHA: ", senha);

        // TODO: VERIFICAR AS VALIDAÇÕES QUE ELES ESTÃO APRENDENDO EM ALGORITMOS 
        if (email == "" || senha == "") {
            window.alert("Preencha todos os campos para prosseguir!");
            finalizarAguardar();
            return false;
        }

        if (email.indexOf("@") == -1 || email.toLowerCase().indexOf(".com") == -1) {
            window.alert("Ops, e-mail inválido! Verifique e tente novamente.");
            finalizarAguardar();
            return false;
        }

        fetch("/usuarios/autenticar", {
            method: "POST",
            body: formulario
        }).then(function (resposta) {
            console.log("ESTOU NO THEN DO entrar()!")

            if (resposta.ok) {
                console.log(resposta);

                resposta.json().then(json => {
                    console.log(json);
                    console.log(JSON.stringify(json));

                    sessionStorage.EMAIL_USUARIO = json.email;
                    sessionStorage.NOME_USUARIO = json.nome;
                    sessionStorage.ID_USUARIO = json.idUser;

                    setTimeout(function () {
                      if (email == "ana.silva@bandtec.com.br"){
                        window.location = "./dashboard.html";
                      } else {
                        window.location = "./tela-perfil.html"
                      }
                    }, 1000); // apenas para exibir o loading

                });

            } else {

                console.log("Houve um erro ao tentar realizar o login!");

                resposta.text().then(texto => {
                    console.error(texto);
                    alert(texto);
                    finalizarAguardar(texto);
                });
            }

        }).catch(function (erro) {
            console.log(erro);
        })

        return false;
    }


</script>